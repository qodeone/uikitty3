/*! UIkit 3.0.0-beta.1 | http://www.getuikit.com | (c) 2014 - 2016 YOOtheme | MIT License */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("uikit")):"function"==typeof define&&define.amd?define(["uikit"],t):t(e.UIkit)}(this,function(e){"use strict";function t(e,t){return t.match(new RegExp("^"+e.replace(/\//g,"\\/").replace(/\*\*/g,"(\\/[^\\/]+)*").replace(/\*/g,"[^\\/]+").replace(/((?!\\))\?/g,"$1.")+"$","i"))}function r(e,t){for(var r=[],a=0;a<e.length;a+=t){for(var l=[],n=0;n<t;n++)l.push(e[a+n]);r.push(l)}return r}var a=e.util.$,l=e.util.ajax,n=e.util.on;UIkit.component("upload",{props:{allow:String,clsDragover:String,concurrent:Number,dataType:String,mime:String,msgInvalidMime:String,msgInvalidName:String,multiple:Boolean,name:String,params:Object,type:String,url:String},defaults:{allow:!1,clsDragover:"uk-dragover",concurrent:1,dataType:void 0,mime:!1,msgInvalidMime:"Invalid File Type: %s",msgInvalidName:"Invalid File Name: %s",multiple:!1,name:"files[]",params:{},type:"POST",url:"",abort:null,beforeAll:null,beforeSend:null,complete:null,completeAll:null,error:null,fail:function(e){alert(e)},load:null,loadEnd:null,loadStart:null,progress:null},events:{change:function(e){a(e.target).is('input[type="file"]')&&(e.preventDefault(),e.target.files&&this.upload(e.target.files),e.target.value="")},drop:function(e){e.preventDefault(),e.stopPropagation();var t=e.originalEvent.dataTransfer;t&&t.files&&(this.$el.removeClass(this.clsDragover),this.upload(t.files))},dragenter:function(e){e.preventDefault(),e.stopPropagation()},dragover:function(e){e.preventDefault(),e.stopPropagation(),this.$el.addClass(this.clsDragover)},dragleave:function(e){e.preventDefault(),e.stopPropagation(),this.$el.removeClass(this.clsDragover)}},methods:{upload:function e(i){var o=this;if(i.length){this.$el.trigger("upload",[i]);for(var s=0;s<i.length;s++){if(this.allow&&!t(this.allow,i[s].name))return void this.fail(this.msgInvalidName.replace(/%s/,this.allow));if(this.mime&&!t(this.mime,i[s].type))return void this.fail(this.msgInvalidMime.replace(/%s/,this.mime))}this.multiple||(i=[i[0]]),this.beforeAll&&this.beforeAll(this,i);var p=r(i,this.concurrent),e=function e(t){var r=new FormData;t.forEach(function(e){return r.append(o.name,e)});for(var i in o.params)r.append(i,o.params[i]);l({data:r,url:o.url,type:o.type,dataType:o.dataType,beforeSend:o.beforeSend,complete:[o.complete,function(t,r){p.length?e(p.shift()):o.completeAll&&o.completeAll(t),"abort"===r&&o.abort&&o.abort(t)}],cache:!1,contentType:!1,processData:!1,xhr:function e(){var e=a.ajaxSettings.xhr();return e.upload&&o.progress&&n(e.upload,"progress",o.progress),["loadStart","load","loadEnd","error","abort"].forEach(function(t){return o[t]&&n(e,t.toLowerCase(),o[t])}),e}})};e(p.shift())}}}})});